apiVersion: lazyfwd/v1

# Example lazyfwd configuration file
# Copy this to ~/.lazyfwd.yaml and customize for your environment

# Verbose logging (can also use --verbose flag with higher priority)
# verbose: false 

# Auto-reload on file changes. Any changes need `brew services restart lazyfwd` while it is false.
auto_reload_config: true 

http:
  # Listen address - handles both HTTP and HTTPS (TLS passthrough) on same port
  listen: ":8989"

  # Idle timeout before closing tunnels (Go duration format)
  # After this duration of no traffic, the tunnel will be closed
  idle_timeout: 60m

  k8s:
    # Path to kubeconfig (optional, defaults to ~/.kube/config)
    # kubeconfig: ~/.kube/config

    routes:
      # Example: ArgoCD server via service (discovers pod automatically)
      argocd.localhost:
        context: my-cluster-context # Kubernetes context name from kubeconfig
        namespace: argocd           # Kubernetes namespace
        service: argocd-server      # Kubernetes service name
        port: 443                   # Service port (automatically resolves to container targetPort)
        scheme: https               # Set X-Forwarded-Proto header (use "https" to prevent HTTPS redirects)

      # Example: Grafana dashboard via service
      grafana.localhost:
        context: my-cluster-context
        namespace: monitoring
        service: grafana
        port: 3000
        # scheme: http              # Default is "http", no need to specify

      # Example: Direct pod targeting (no pod discovery)
      # debug.localhost:
      #   context: microk8s
      #   namespace: default
      #   pod: my-debug-pod         # Pod name (use instead of service)
      #   port: 8080
